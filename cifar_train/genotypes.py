Genotype = namedtuple('Genotype', 'gene concat')

PRIMITIVES = [
    'skip_connect',
    'sep_conv_3x3',
    'sep_conv_5x5',
    'dil_conv_3x3',
    'dil_conv_5x5',
    'avg_pool_3x3',
    'max_pool_3x3',
]

# discovered arch on CIFAR-10 on DARTS search space
MGAS = Genotype(gene=[[('sep_conv_3x3', 0, 2, [42, 42, 42]), ('sep_conv_5x5', 0, 2, [42, 44, 42]), ('dil_conv_3x3', 0, 2, [42, 42]), ('dil_conv_5x5', 0, 2, [42, 42]), ('skip_connect', 1, 2, [42]), ('sep_conv_3x3', 1, 2, [42, 44, 42]), ('sep_conv_5x5', 1, 2, [42, 42, 42]), ('dil_conv_3x3', 1, 2, [42, 42]), ('dil_conv_5x5', 1, 2, [42, 42]), ('skip_connect', 0, 3, [42]), ('sep_conv_5x5', 0, 3, [42, 44, 42]), ('sep_conv_3x3', 1, 3, [42, 44, 42]), ('sep_conv_5x5', 1, 3, [42, 44, 42]), ('skip_connect', 2, 3, [42]), ('sep_conv_3x3', 2, 3, [42, 44, 42]), ('sep_conv_5x5', 2, 3, [42, 42, 42]), ('dil_conv_5x5', 2, 3, [42, 42]), ('max_pool_3x3', 1, 4, [42]), ('sep_conv_3x3', 2, 4, [42, 44, 42]), ('sep_conv_5x5', 2, 4, [42, 44, 42]), ('dil_conv_5x5', 2, 4, [42, 42]), ('skip_connect', 3, 4, [42]), ('dil_conv_3x3', 3, 4, [42, 42]), ('max_pool_3x3', 2, 5, [42]), ('max_pool_3x3', 3, 5, [42])], [('sep_conv_3x3', 0, 2, [42, 44, 42]), ('dil_conv_5x5', 0, 2, [42, 42]), ('skip_connect', 1, 2, [42]), ('sep_conv_3x3', 1, 2, [42, 44, 42]), ('dil_conv_3x3', 1, 2, [42, 42]), ('dil_conv_5x5', 1, 2, [42, 42]), ('max_pool_3x3', 0, 3, [42]), ('sep_conv_3x3', 1, 3, [42, 42, 42]), ('skip_connect', 2, 3, [42]), ('dil_conv_5x5', 2, 3, [42, 42]), ('skip_connect', 0, 4, [42]), ('skip_connect', 1, 4, [42]), ('sep_conv_5x5', 1, 4, [42, 42, 42]), ('dil_conv_5x5', 2, 4, [42, 42]), ('skip_connect', 3, 4, [42]), ('sep_conv_5x5', 2, 5, [42, 42, 42]), ('dil_conv_5x5', 2, 5, [42, 42]), ('sep_conv_5x5', 3, 5, [42, 42, 42]), ('max_pool_3x3', 3, 5, [42]), ('sep_conv_5x5', 4, 5, [42, 42, 42])], [('skip_connect', 0, 2, [32]), ('skip_connect', 1, 2, [32]), ('sep_conv_3x3', 1, 2, [32, 44, 32]), ('sep_conv_5x5', 1, 2, [32, 32, 32]), ('sep_conv_5x5', 0, 3, [32, 32, 32]), ('sep_conv_3x3', 2, 3, [32, 32, 32]), ('max_pool_3x3', 2, 3, [32]), ('sep_conv_3x3', 0, 4, [32, 32, 32]), ('sep_conv_3x3', 3, 4, [32, 32, 32]), ('avg_pool_3x3', 3, 4, [32]), ('max_pool_3x3', 1, 5, [32]), ('skip_connect', 2, 5, [32]), ('max_pool_3x3', 4, 5, [32])], [('skip_connect', 0, 2, [24]), ('avg_pool_3x3', 0, 2, [24]), ('sep_conv_3x3', 1, 2, [24, 24, 24]), ('sep_conv_5x5', 1, 2, [24, 24, 24]), ('skip_connect', 0, 3, [24]), ('avg_pool_3x3', 2, 3, [24]), ('sep_conv_5x5', 2, 4, [24, 24, 24]), ('sep_conv_3x3', 3, 4, [24, 24, 24]), ('sep_conv_5x5', 3, 4, [24, 24, 24]), ('avg_pool_3x3', 3, 4, [24]), ('sep_conv_5x5', 0, 5, [24, 24, 24]), ('sep_conv_3x3', 1, 5, [24, 24, 24]), ('sep_conv_5x5', 2, 5, [24, 24, 24]), ('sep_conv_5x5', 3, 5, [24, 24, 24]), ('dil_conv_5x5', 3, 5, [24, 24]), ('max_pool_3x3', 4, 5, [24])], [('skip_connect', 0, 2, [70]), ('sep_conv_3x3', 0, 2, [70, 88, 70]), ('sep_conv_5x5', 0, 2, [70, 70, 70]), ('avg_pool_3x3', 0, 2, [70]), ('sep_conv_3x3', 1, 2, [70, 70, 70]), ('sep_conv_5x5', 1, 2, [70, 70, 70]), ('sep_conv_3x3', 0, 3, [70, 70, 70]), ('skip_connect', 2, 3, [70]), ('skip_connect', 0, 4, [70]), ('sep_conv_5x5', 1, 4, [70, 70, 70]), ('avg_pool_3x3', 1, 4, [70]), ('sep_conv_3x3', 3, 4, [70, 70, 70]), ('sep_conv_5x5', 3, 4, [70, 70, 70]), ('sep_conv_3x3', 0, 5, [70, 70, 70]), ('sep_conv_3x3', 1, 5, [70, 70, 70]), ('sep_conv_3x3', 2, 5, [70, 70, 70]), ('sep_conv_3x3', 3, 5, [70, 70, 70]), ('max_pool_3x3', 3, 5, [70]), ('max_pool_3x3', 4, 5, [70])], [('skip_connect', 0, 2, [62]), ('sep_conv_3x3', 0, 2, [62, 88, 62]), ('dil_conv_3x3', 0, 2, [62, 62]), ('skip_connect', 1, 2, [62]), ('sep_conv_3x3', 1, 2, [62, 88, 62]), ('sep_conv_5x5', 1, 2, [62, 88, 62]), ('dil_conv_3x3', 1, 2, [62, 62]), ('dil_conv_5x5', 1, 2, [62, 62]), ('skip_connect', 0, 3, [62]), ('sep_conv_5x5', 1, 3, [62, 62, 62]), ('sep_conv_5x5', 2, 3, [62, 62, 62]), ('max_pool_3x3', 2, 3, [62]), ('sep_conv_5x5', 0, 4, [62, 62, 62]), ('sep_conv_5x5', 1, 4, [62, 88, 62]), ('skip_connect', 2, 4, [62]), ('sep_conv_5x5', 2, 4, [62, 62, 62]), ('skip_connect', 3, 4, [62]), ('sep_conv_5x5', 1, 5, [62, 62, 62]), ('sep_conv_5x5', 3, 5, [62, 62, 62]), ('max_pool_3x3', 3, 5, [62]), ('max_pool_3x3', 4, 5, [62])], [('skip_connect', 0, 2, [84]), ('dil_conv_5x5', 0, 2, [84, 84]), ('max_pool_3x3', 0, 2, [84]), ('dil_conv_5x5', 1, 2, [84, 84]), ('avg_pool_3x3', 1, 2, [84]), ('max_pool_3x3', 1, 2, [84]), ('dil_conv_5x5', 2, 3, [84, 84]), ('max_pool_3x3', 2, 3, [84]), ('sep_conv_3x3', 1, 4, [84, 84, 84]), ('sep_conv_5x5', 2, 4, [84, 84, 84]), ('sep_conv_5x5', 0, 5, [84, 84, 84]), ('max_pool_3x3', 3, 5, [84])], [('sep_conv_5x5', 0, 2, [54, 88, 54]), ('dil_conv_5x5', 0, 2, [54, 54]), ('avg_pool_3x3', 0, 2, [54]), ('skip_connect', 1, 2, [54]), ('sep_conv_5x5', 1, 2, [54, 88, 54]), ('dil_conv_5x5', 1, 2, [54, 54]), ('sep_conv_5x5', 1, 3, [54, 54, 54]), ('skip_connect', 2, 3, [54]), ('sep_conv_5x5', 2, 3, [54, 54, 54]), ('max_pool_3x3', 2, 3, [54]), ('sep_conv_3x3', 1, 4, [54, 54, 54]), ('max_pool_3x3', 2, 4, [54]), ('max_pool_3x3', 3, 4, [54]), ('max_pool_3x3', 4, 5, [54])], [('skip_connect', 0, 2, [82]), ('dil_conv_5x5', 0, 2, [82, 82]), ('max_pool_3x3', 0, 2, [82]), ('max_pool_3x3', 1, 2, [82]), ('sep_conv_3x3', 0, 3, [82, 82, 82]), ('sep_conv_5x5', 0, 3, [82, 82, 82]), ('dil_conv_5x5', 2, 3, [82, 82]), ('max_pool_3x3', 2, 3, [82]), ('dil_conv_5x5', 0, 4, [82, 82]), ('max_pool_3x3', 3, 4, [82]), ('max_pool_3x3', 4, 5, [82])], [('skip_connect', 0, 2, [100]), ('sep_conv_3x3', 0, 2, [100, 176, 100]), ('avg_pool_3x3', 0, 2, [100]), ('sep_conv_5x5', 0, 3, [100, 176, 100]), ('avg_pool_3x3', 0, 3, [100]), ('avg_pool_3x3', 1, 3, [100]), ('sep_conv_3x3', 2, 3, [100, 100, 100]), ('sep_conv_5x5', 2, 3, [100, 100, 100]), ('dil_conv_3x3', 2, 3, [100, 100]), ('dil_conv_5x5', 2, 3, [100, 100]), ('sep_conv_5x5', 0, 4, [100, 176, 100]), ('avg_pool_3x3', 0, 4, [100]), ('skip_connect', 1, 4, [100]), ('sep_conv_3x3', 1, 4, [100, 100, 100]), ('skip_connect', 2, 4, [100]), ('avg_pool_3x3', 2, 4, [100]), ('dil_conv_3x3', 3, 4, [100, 100]), ('skip_connect', 0, 5, [100]), ('sep_conv_3x3', 0, 5, [100, 176, 100]), ('dil_conv_3x3', 0, 5, [100, 100]), ('dil_conv_5x5', 0, 5, [100, 100]), ('avg_pool_3x3', 1, 5, [100]), ('max_pool_3x3', 1, 5, [100]), ('dil_conv_5x5', 3, 5, [100, 100]), ('max_pool_3x3', 4, 5, [100])], [('skip_connect', 0, 2, [88]), ('sep_conv_3x3', 0, 2, [88, 168, 88]), ('sep_conv_5x5', 0, 2, [88, 176, 88]), ('avg_pool_3x3', 0, 2, [88]), ('max_pool_3x3', 0, 2, [88]), ('sep_conv_3x3', 1, 2, [88, 88, 88]), ('sep_conv_5x5', 1, 2, [88, 88, 88]), ('sep_conv_3x3', 0, 3, [88, 174, 88]), ('sep_conv_3x3', 1, 3, [88, 88, 88]), ('dil_conv_5x5', 1, 3, [88, 88]), ('dil_conv_5x5', 2, 3, [88, 88]), ('avg_pool_3x3', 1, 4, [88]), ('skip_connect', 3, 4, [88]), ('skip_connect', 0, 5, [88]), ('sep_conv_5x5', 0, 5, [88, 88, 88]), ('skip_connect', 2, 5, [88]), ('max_pool_3x3', 2, 5, [88]), ('dil_conv_3x3', 3, 5, [88, 88]), ('skip_connect', 4, 5, [88]), ('max_pool_3x3', 4, 5, [88])], [('skip_connect', 1, 2, [94]), ('sep_conv_3x3', 1, 2, [94, 176, 94]), ('sep_conv_5x5', 1, 2, [94, 94, 94]), ('max_pool_3x3', 1, 2, [94]), ('skip_connect', 1, 3, [94]), ('max_pool_3x3', 1, 3, [94]), ('skip_connect', 1, 4, [94]), ('sep_conv_5x5', 1, 4, [94, 176, 94]), ('avg_pool_3x3', 1, 4, [94]), ('max_pool_3x3', 1, 4, [94]), ('max_pool_3x3', 2, 4, [94]), ('max_pool_3x3', 3, 4, [94]), ('max_pool_3x3', 1, 5, [94]), ('dil_conv_5x5', 2, 5, [94, 94]), ('max_pool_3x3', 2, 5, [94]), ('dil_conv_3x3', 3, 5, [94, 94]), ('max_pool_3x3', 4, 5, [94])], [('sep_conv_3x3', 0, 2, [130, 130, 130]), ('max_pool_3x3', 0, 2, [130]), ('dil_conv_5x5', 1, 2, [130, 130]), ('sep_conv_3x3', 0, 3, [130, 130, 130]), ('sep_conv_3x3', 2, 3, [130, 130, 130]), ('max_pool_3x3', 2, 3, [130]), ('sep_conv_5x5', 2, 4, [130, 130, 130]), ('max_pool_3x3', 2, 4, [130]), ('dil_conv_3x3', 4, 5, [130, 130]), ('max_pool_3x3', 4, 5, [130])], [('max_pool_3x3', 1, 2, [176]), ('max_pool_3x3', 1, 3, [176]), ('sep_conv_5x5', 0, 4, [176, 176, 176]), ('max_pool_3x3', 1, 4, [176]), ('sep_conv_5x5', 2, 4, [176, 176, 176]), ('max_pool_3x3', 2, 5, [176])]], concat=range(2, 6))
